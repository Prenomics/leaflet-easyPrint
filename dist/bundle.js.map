{"version":3,"file":"bundle.js","sources":["../src/main.js"],"sourcesContent":["const domtoimage = require('dom-to-image');\nconst fileSaver = require('file-saver');\nimport * as L from 'leaflet';\n\nL.Control.EasyPrint = L.Control.extend({\n    options: {\n        title: 'Print map',\n        position: 'topleft',\n        sizeModes: ['Current'],\n        filename: 'map',\n        exportOnly: false,\n        hidden: false,\n        tileWait: 500,\n        hideControlContainer: true,\n        hideClasses: [],\n        customWindowTitle: window.document.title,\n        spinnerBgCOlor: '#0DC5C1',\n        customSpinnerClass: 'epLoader',\n        defaultSizeTitles: {\n            Current: 'Current Size',\n            A4Landscape: 'A4 Landscape',\n            A4Portrait: 'A4 Portrait'\n        }\n    },\n\n    onAdd: function () {\n        this.mapContainer = this._map.getContainer();\n        this.options.sizeModes = this.options.sizeModes.map(function (sizeMode) {\n            if (sizeMode === 'Current') {\n                return {\n                    name: this.options.defaultSizeTitles.Current,\n                    className: 'CurrentSize'\n                };\n            }\n            if (sizeMode === 'A4Landscape') {\n                return {\n                    height: this._a4PageSize.height,\n                    width: this._a4PageSize.width,\n                    name: this.options.defaultSizeTitles.A4Landscape,\n                    className: 'A4Landscape page'\n                };\n            }\n            if (sizeMode === 'A4Portrait') {\n                return {\n                    height: this._a4PageSize.width,\n                    width: this._a4PageSize.height,\n                    name: this.options.defaultSizeTitles.A4Portrait,\n                    className: 'A4Portrait page'\n                };\n            }\n            ;\n            return sizeMode;\n        }, this);\n\n        var container = L.DomUtil.create('div', 'leaflet-control-easyPrint leaflet-bar leaflet-control');\n        if (!this.options.hidden) {\n            L.DomEvent.addListener(container, 'mouseover', this._togglePageSizeButtons, this);\n            L.DomEvent.addListener(container, 'mouseout', this._togglePageSizeButtons, this);\n\n            var btnClass = 'leaflet-control-easyPrint-button';\n            if (this.options.exportOnly) btnClass = btnClass + '-export';\n\n            this.link = L.DomUtil.create('a', btnClass, container);\n            this.link.id = 'leafletEasyPrint';\n            this.link.title = this.options.title;\n            this.holder = L.DomUtil.create('ul', 'easyPrintHolder', container);\n\n            this.options.sizeModes.forEach(function (sizeMode) {\n                var btn = L.DomUtil.create('li', 'easyPrintSizeMode', this.holder);\n                btn.title = sizeMode.name;\n                var link = L.DomUtil.create('a', sizeMode.className, btn);\n                L.DomEvent.addListener(btn, 'click', this.printMap, this);\n            }, this);\n\n            L.DomEvent.disableClickPropagation(container);\n        }\n        return container;\n    },\n\n    printMap: function (event, filename) {\n        if (filename) {\n            this.options.filename = filename;\n        }\n        if (!this.options.exportOnly) {\n            this._page = window.open('', '_blank', 'toolbar=no,status=no,menubar=no,scrollbars=no,resizable=no,left=10, top=10, width=200, height=250, visible=none');\n            this._page.document.write(this._createSpinner(this.options.customWindowTitle, this.options.customSpinnerClass, this.options.spinnerBgCOlor));\n        }\n        this.originalState = {\n            mapWidth: this.mapContainer.style.width,\n            widthWasAuto: false,\n            widthWasPercentage: false,\n            mapHeight: this.mapContainer.style.height,\n            zoom: this._map.getZoom(),\n            center: this._map.getCenter()\n        };\n        if (this.originalState.mapWidth === 'auto') {\n            this.originalState.mapWidth = this._map.getSize().x + 'px';\n            this.originalState.widthWasAuto = true;\n        } else if (this.originalState.mapWidth.includes('%')) {\n            this.originalState.percentageWidth = this.originalState.mapWidth;\n            this.originalState.widthWasPercentage = true;\n            this.originalState.mapWidth = this._map.getSize().x + 'px';\n        }\n        this._map.fire('easyPrint-start', {event: event});\n        if (!this.options.hidden) {\n            this._togglePageSizeButtons({type: null});\n        }\n        if (this.options.hideControlContainer) {\n            this._toggleControls();\n        }\n        if (this.options.hideClasses) {\n            this._toggleClasses(this.options.hideClasses);\n        }\n        var sizeMode = typeof event !== 'string' ? event.target.className : event;\n        if (sizeMode === 'CurrentSize') {\n            return this._printOpertion(sizeMode);\n        }\n        this.outerContainer = this._createOuterContainer(this.mapContainer);\n        if (this.originalState.widthWasAuto) {\n            this.outerContainer.style.width = this.originalState.mapWidth;\n        }\n        this._createImagePlaceholder(sizeMode);\n    },\n\n    _createImagePlaceholder: function (sizeMode) {\n        var plugin = this;\n        domtoimage.toPng(this.mapContainer, {\n            width: parseInt(this.originalState.mapWidth.replace('px')),\n            height: parseInt(this.originalState.mapHeight.replace('px'))\n        })\n            .then(function (dataUrl) {\n                plugin.blankDiv = document.createElement('div');\n                var blankDiv = plugin.blankDiv;\n                plugin.outerContainer.parentElement.insertBefore(blankDiv, plugin.outerContainer);\n                blankDiv.className = 'epHolder';\n                blankDiv.style.backgroundImage = 'url(\"' + dataUrl + '\")';\n                blankDiv.style.position = 'absolute';\n                blankDiv.style.zIndex = 1011;\n                blankDiv.style.display = 'initial';\n                blankDiv.style.width = plugin.originalState.mapWidth;\n                blankDiv.style.height = plugin.originalState.mapHeight;\n                plugin._resizeAndPrintMap(sizeMode);\n            })\n            .catch(function (error) {\n                console.error('oops, something went wrong!', error);\n            });\n    },\n\n    _resizeAndPrintMap: function (sizeMode) {\n        this.outerContainer.style.opacity = 0;\n        var pageSize = this.options.sizeModes.filter(function (item) {\n            return item.className.indexOf(sizeMode) > -1;\n        });\n        pageSize = pageSize[0];\n        this.mapContainer.style.width = pageSize.width + 'px';\n        this.mapContainer.style.height = pageSize.height + 'px';\n        if (this.mapContainer.style.width > this.mapContainer.style.height) {\n            this.orientation = 'portrait';\n        } else {\n            this.orientation = 'landscape';\n        }\n        this._map.setView(this.originalState.center);\n        this._map.setZoom(this.originalState.zoom);\n        this._map.invalidateSize();\n        if (this.options.tileLayer) {\n            this._pausePrint(sizeMode);\n        } else {\n            this._printOpertion(sizeMode);\n        }\n    },\n\n    _pausePrint: function (sizeMode) {\n        var plugin = this;\n        var loadingTest = setInterval(function () {\n            if (!plugin.options.tileLayer.isLoading()) {\n                clearInterval(loadingTest);\n                plugin._printOpertion(sizeMode);\n            }\n        }, plugin.options.tileWait);\n    },\n\n    _printOpertion: function (sizemode) {\n        var plugin = this;\n        var widthForExport = this.mapContainer.style.width;\n        if (this.originalState.widthWasAuto && sizemode === 'CurrentSize' || this.originalState.widthWasPercentage && sizemode === 'CurrentSize') {\n            widthForExport = this.originalState.mapWidth;\n        }\n        domtoimage.toPng(plugin.mapContainer, {\n            width: parseInt(widthForExport),\n            height: parseInt(plugin.mapContainer.style.height.replace('px'))\n        })\n            .then(function (dataUrl) {\n                var blob = plugin._dataURItoBlob(dataUrl);\n                if (plugin.options.exportOnly) {\n                    fileSaver.saveAs(blob, plugin.options.filename + '.png');\n                } else {\n                    plugin._sendToBrowserPrint(dataUrl, plugin.orientation);\n                }\n                plugin._toggleControls(true);\n                plugin._toggleClasses(plugin.options.hideClasses, true);\n\n                if (plugin.outerContainer) {\n                    if (plugin.originalState.widthWasAuto) {\n                        plugin.mapContainer.style.width = 'auto';\n                    } else if (plugin.originalState.widthWasPercentage) {\n                        plugin.mapContainer.style.width = plugin.originalState.percentageWidth;\n                    } else {\n                        plugin.mapContainer.style.width = plugin.originalState.mapWidth;\n                    }\n                    plugin.mapContainer.style.height = plugin.originalState.mapHeight;\n                    plugin._removeOuterContainer(plugin.mapContainer, plugin.outerContainer, plugin.blankDiv);\n                    plugin._map.invalidateSize();\n                    plugin._map.setView(plugin.originalState.center);\n                    plugin._map.setZoom(plugin.originalState.zoom);\n                }\n                plugin._map.fire('easyPrint-finished');\n            })\n            .catch(function (error) {\n                console.error('Print operation failed', error);\n            });\n    },\n\n    _sendToBrowserPrint: function (img, orientation) {\n        this._page.resizeTo(600, 800);\n        var pageContent = this._createNewWindow(img, orientation, this);\n        this._page.document.body.innerHTML = '';\n        this._page.document.write(pageContent);\n        this._page.document.close();\n    },\n\n    _createSpinner: function (title, spinnerClass, spinnerColor) {\n        return `<html><head><title>` + title + `</title></head><body><style>\n      body{\n        background: ` + spinnerColor + `;\n      }\n      .epLoader,\n      .epLoader:before,\n      .epLoader:after {\n        border-radius: 50%;\n      }\n      .epLoader {\n        color: #ffffff;\n        font-size: 11px;\n        text-indent: -99999em;\n        margin: 55px auto;\n        position: relative;\n        width: 10em;\n        height: 10em;\n        box-shadow: inset 0 0 0 1em;\n        -webkit-transform: translateZ(0);\n        -ms-transform: translateZ(0);\n        transform: translateZ(0);\n      }\n      .epLoader:before,\n      .epLoader:after {\n        position: absolute;\n        content: '';\n      }\n      .epLoader:before {\n        width: 5.2em;\n        height: 10.2em;\n        background: #0dc5c1;\n        border-radius: 10.2em 0 0 10.2em;\n        top: -0.1em;\n        left: -0.1em;\n        -webkit-transform-origin: 5.2em 5.1em;\n        transform-origin: 5.2em 5.1em;\n        -webkit-animation: load2 2s infinite ease 1.5s;\n        animation: load2 2s infinite ease 1.5s;\n      }\n      .epLoader:after {\n        width: 5.2em;\n        height: 10.2em;\n        background: #0dc5c1;\n        border-radius: 0 10.2em 10.2em 0;\n        top: -0.1em;\n        left: 5.1em;\n        -webkit-transform-origin: 0px 5.1em;\n        transform-origin: 0px 5.1em;\n        -webkit-animation: load2 2s infinite ease;\n        animation: load2 2s infinite ease;\n      }\n      @-webkit-keyframes load2 {\n        0% {\n          -webkit-transform: rotate(0deg);\n          transform: rotate(0deg);\n        }\n        100% {\n          -webkit-transform: rotate(360deg);\n          transform: rotate(360deg);\n        }\n      }\n      @keyframes load2 {\n        0% {\n          -webkit-transform: rotate(0deg);\n          transform: rotate(0deg);\n        }\n        100% {\n          -webkit-transform: rotate(360deg);\n          transform: rotate(360deg);\n        }\n      }\n      </style>\n    <div class=\"` + spinnerClass + `\">Loading...</div></body></html>`;\n    },\n\n    _createNewWindow: function (img, orientation) {\n        return `<html><head>\n        <style>@media print {\n          img { max-width: 98%!important; max-height: 98%!important; }\n          @page { size: ` + orientation + `;}}\n        </style>\n        <script>function step1(){\n        setTimeout('step2()', 10);}\n        function step2(){window.print();window.close()}\n        </script></head><body onload='step1()'>\n        <img alt=\"` + img + `\" src=\"` + img + `\" style=\"display:block; margin:auto;\"></body></html>`;\n    },\n\n    _createOuterContainer: function (mapDiv) {\n        var outerContainer = document.createElement('div');\n        mapDiv.parentNode.insertBefore(outerContainer, mapDiv);\n        mapDiv.parentNode.removeChild(mapDiv);\n        outerContainer.appendChild(mapDiv);\n        outerContainer.style.width = mapDiv.style.width;\n        outerContainer.style.height = mapDiv.style.height;\n        outerContainer.style.display = 'inline-block';\n        outerContainer.style.overflow = 'hidden';\n        return outerContainer;\n    },\n\n    _removeOuterContainer: function (mapDiv, outerContainer, blankDiv) {\n        if (outerContainer.parentNode) {\n            outerContainer.parentNode.insertBefore(mapDiv, outerContainer);\n            outerContainer.parentNode.removeChild(blankDiv);\n            outerContainer.parentNode.removeChild(outerContainer);\n        }\n    },\n\n    _dataURItoBlob: function (dataURI) {\n        var byteString = atob(dataURI.split(',')[1]);\n        var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\n        var ab = new ArrayBuffer(byteString.length);\n        var dw = new DataView(ab);\n        for (var i = 0; i < byteString.length; i++) {\n            dw.setUint8(i, byteString.charCodeAt(i));\n        }\n        return new Blob([ab], {type: mimeString});\n    },\n\n    _togglePageSizeButtons: function (e) {\n        var holderStyle = this.holder.style;\n        var linkStyle = this.link.style;\n        if (e.type === 'mouseover') {\n            holderStyle.display = 'block';\n            linkStyle.borderTopRightRadius = '0';\n            linkStyle.borderBottomRightRadius = '0';\n        } else {\n            holderStyle.display = 'none';\n            linkStyle.borderTopRightRadius = '2px';\n            linkStyle.borderBottomRightRadius = '2px';\n        }\n    },\n\n    _toggleControls: function (show) {\n        var controlContainer = document.getElementsByClassName('leaflet-control-container')[0];\n        if (show) return controlContainer.style.display = 'block';\n        controlContainer.style.display = 'none';\n    },\n    _toggleClasses: function (classes, show) {\n        classes.forEach(function (className) {\n            var div = document.getElementsByClassName(className)[0];\n            if (show) return div.style.display = 'block';\n            div.style.display = 'none';\n        });\n    },\n\n    _a4PageSize: {\n        height: 715,\n        width: 1045\n    }\n\n});\n\nexport const easyPrint = function (options) {\n    return new L.Control.EasyPrint(options);\n};\n"],"names":["domtoimage","require","fileSaver","L.Control","EasyPrint","extend","options","title","position","sizeModes","filename","exportOnly","hidden","tileWait","hideControlContainer","hideClasses","customWindowTitle","window","document","spinnerBgCOlor","customSpinnerClass","defaultSizeTitles","Current","A4Landscape","A4Portrait","onAdd","this","mapContainer","_map","getContainer","map","sizeMode","name","className","height","_a4PageSize","width","container","L.DomUtil","create","L.DomEvent","addListener","_togglePageSizeButtons","btnClass","link","id","holder","forEach","btn","printMap","disableClickPropagation","event","_page","open","write","_createSpinner","originalState","mapWidth","style","widthWasAuto","widthWasPercentage","mapHeight","zoom","getZoom","center","getCenter","getSize","x","includes","percentageWidth","fire","type","_toggleControls","_toggleClasses","target","_printOpertion","outerContainer","_createOuterContainer","_createImagePlaceholder","plugin","toPng","parseInt","replace","then","dataUrl","blankDiv","createElement","parentElement","insertBefore","backgroundImage","zIndex","display","_resizeAndPrintMap","catch","error","console","opacity","pageSize","filter","item","indexOf","orientation","setView","setZoom","invalidateSize","tileLayer","_pausePrint","loadingTest","setInterval","isLoading","clearInterval","sizemode","widthForExport","blob","_dataURItoBlob","saveAs","_sendToBrowserPrint","_removeOuterContainer","img","resizeTo","pageContent","_createNewWindow","body","innerHTML","close","spinnerClass","spinnerColor","mapDiv","parentNode","removeChild","appendChild","overflow","dataURI","byteString","atob","split","mimeString","ab","ArrayBuffer","length","dw","DataView","i","setUint8","charCodeAt","Blob","e","holderStyle","linkStyle","borderTopRightRadius","borderBottomRightRadius","show","controlContainer","getElementsByClassName","classes","div","easyPrint"],"mappings":"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"}